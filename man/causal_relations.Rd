% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/causal_sentences.R
\name{causal_relations}
\alias{causal_relations}
\title{Extract causal relations from sentence(s) via a Hugging Face Space}
\usage{
causal_relations(
  sentence,
  rel_mode = "auto",
  rel_threshold = 0.5,
  cause_decision = "cls+span",
  timeout = 10,
  verbose = FALSE
)
}
\arguments{
\item{sentence}{A character vector of one or more sentences to analyze for causal relations.}

\item{rel_mode}{Relation extraction mode. Options are \code{"auto"} (default) or \code{"neural_only"}.}

\item{rel_threshold}{Numeric threshold (default \code{0.5}) for deciding whether a relation is considered causal.}

\item{cause_decision}{Strategy for cause/effect detection. Options: \code{"cls_only"}, \code{"span_only"}, or \code{"cls+span"} (default).}

\item{timeout}{Maximum time (in seconds) to wait for the Hugging Face Space to return a result via SSE before aborting. Default is \code{10}.}

\item{verbose}{Logical; if \code{TRUE}, prints diagnostic information (URLs, status codes, event progression). Default \code{FALSE}.}
}
\value{
A base \code{data.frame} with columns:
\itemize{
\item \code{sentence} (character): the original input sentence,
\item \code{causal}   (logical):   whether the sentence is causal per the model,
\item \code{cause}    (character): extracted cause span (or \code{NA}),
\item \code{effect}   (character): extracted effect span (or \code{NA}).
}
}
\description{
Sends one or more input sentences to a public Gradio app hosted on Hugging Face
(the \emph{lakens-causal-sentences} Space), created based on code by Rasoul Norouzi, retrieves the result via Server-Sent Events (SSE),
and returns a tidy data frame with one row per detected cause–effect relation.
}
\details{
The function uses Gradio’s two-step queue API:
(1) a POST request enqueues the job and returns an \code{event_id};
(2) a GET request streams \code{text/event-stream} frames until \code{event: complete}.
Many Gradio apps emit a \strong{double-encoded} completion payload of the form
\verb{["<final JSON string>"]}. This function unwraps that to obtain the final JSON
structure (an array of items containing \code{causal} and \code{relations}) before parsing.

If a sentence has \strong{no relations}, the output includes one row with \code{cause = NA},
\code{effect = NA}, and the sentence’s \code{causal} flag (as returned by the model). For
sentences with \strong{multiple relations}, the function returns one row per relation.
}
\examples{
\dontrun{
# Single sentence
df1 <- causal_relations("Smoking causes cancer")
print(df1)

# Multiple sentences (batch)
df2 <- causal_relations(c("Insomnia causes depression.", "Rain leads to flooding."))
print(df2)

# Custom parameters and verbose diagnostics
df3 <- causal_relations(
  sentence = "Stress increases blood pressure.",
  rel_mode = "auto",
  rel_threshold = 0.4,
  cause_decision = "cls+span",
  timeout = 10,
  verbose = TRUE
)
print(df3)
}
}
\references{
Norouzi, R., Kleinberg, B., Vermunt, J. K., & van Lissa, C. J. (2025).
Capturing causal claims: A fine-tuned text mining model for extracting causal sentences from social science papers.
\emph{Research Synthesis Methods}, 16(1), 139–156. https://doi.org/10.1017/rsm.2024.13

Hugging Face Model Card: rasoultilburg/SocioCausaNet
https://huggingface.co/rasoultilburg/SocioCausaNet
}
